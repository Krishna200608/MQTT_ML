1)Navigate to folder
D:
cd Research\Code\MQTT_ML


2)Create the env
conda create -n mqtt_ids python=3.12 -y

3)activate the env
conda activate mqtt_ids

4)install dependecies (if not installed)
pip install numpy pandas scikit-learn matplotlib tqdm joblib


MAIN COMMANDS

1) Biflow features
python classification.py --mode 2 --output Bidirectional_Results --verbose True

2)Uniflow features
python classification.py --mode 1 --output Unidirectional_Results --verbose True

3)Packet features
python classification.py --mode 0 --output Packet_Results --verbose True

4)Predict
python predict.py


---run Mosquitoo
mosquitto -v

---Capture benign traffic using script
-- 1) generate ( run in 2-3 terminals)
        python .\scripts\mqtt_simulator.py --client device_A --rate 1.0
        python .\scripts\mqtt_simulator.py --client device_B --rate 1.0
        python .\scripts\mqtt_simulator.py --client device_C --rate 1.0
---2) capture them using tshark (benign traffic)
         -> with duration 60s
                tshark -i 6 -f "tcp port 1883 or udp port 1883" -a duration:60 -F pcap -w .\captures\benign_mqtt.pcap
         -> without
                tshark -i 6 -f "tcp port 1883 or udp port 1883" -F pcap -w .\captures\benign_mqtt.pcap
         -> 1000 packets
                tshark -i 6 -f "tcp port 1883 or udp port 1883" -c 1000 -F pcap -w .\captures\benign_mqtt.pcap
--3) capture attack traffic
        tshark -i 6 -s 0 -f "tcp port 1883 or udp port 1883" -a duration:120 -F pcap -w .\captures\attack_mqtt.pcap
        tshark -i 6 -s 0 -f "tcp port 1883 or udp port 1883" -c 1000 -F pcap -w .\captures\attack_mqtt.pcap
        tshark -i 6 -f "tcp port 1883 or udp port 1883" -F pcap -F pcap -w .\captures\attack_mqtt.pcap

        1)A — Nmap TCP scan (basic scan attack)
            nmap -p 1883 127.0.0.1
            # To run a faster aggressive scan
            nmap -T4 -p 1883 127.0.0.1
        2)B — Nmap UDP scan
            nmap -sU -p 1883 127.0.0.1
        3)python .\scripts\mqtt_bruteforce_sim.py

--4) convert to csv
    python .\scripts\pcap_parser.py .\captures\benign_mqtt.pcap
    python .\scripts\pcap_parser.py .\captures\attack_mqtt.pcap




